/* Copyright (C) 2010-2022, Murad Banaji
 *
 * This file is part of QUALMAT
 *
 * QUALMAT is free software; you can redistribute it and/or 
 * modify it under the terms of the GNU General Public License 
 * as published by the Free Software Foundation; either version 2, 
 * or (at your option) any later version.
 *
 * QUALMAT is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with QUALMAT: see the file COPYING.  If not, write to 
 * the Free Software Foundation, Inc., 59 Temple Place - Suite 330, 
 * Boston, MA 02111-1307, USA. 

 */

#include "hopf.h"

// arguments: 
// input file with one bimolecular crn in di6 format per line
// output file for crns with possible Hopf bifurcation (or NULL)
// output file for crns forbidding Hopf bifurcation (or NULL)
// number of species
// number of reactions
// optional sixth argument: filter to run only some checks (see below)
// optional seventh argument: "verbose" for more output (in this case sixth argument must be set or NULL

// Filters:
// JsquaredP0, i.e., is J^2 a P0 matrix?
// Jcomp2P0, i.e., is J^{2] a P0 matrix
// Jcomp2nonsing, i.e., is J^[2] nonsingular
// J2pInonsing, i.e., is J^2+I nonsingular
// J2pIMAnonsing, i.e., is J^2+I nonsingular for the mass action Jacobian
// NULL for all

// ruleouthopf returns 1 if we can be confident that Hopf bifurcation
// is forbidden, and returns 0 otherwise

// Example command: ./bin/ruleouthopf crndatDNG/s3r4DNGrank3.d6 crndatDNG/s3r4DNGrank3possiblehopf.d6 crndatDNG/s3r4DNGrank3nohopf.d6 3 4 JsquaredP0 verbose 2> crndatDNG/s3r4hopfcheck.log


int main(int argc, char *argv[])
{
  bool q=1;
  int effort=0;
  if(argc<6){
    fprintf(stderr, "You must supply at least five arguments to \"ruleouthopf\":\n\tinput file;\n\toutput file for crns with possible Hopf bifurcation or \"NULL\";\n\toutput file for crns where Hopf bifurcation is ruled out, or \"NULL\";\n\tnumber of species;\n\tnumber of reactions;\n\ta filter (NULL (for all), MAonly, GKonly, JsquaredP0, MAJsquaredP0, Jcomp2P0, MAJcomp2P0, Jcomp2nonsing, MAJcomp2nonsing, J2pInonsing, MAJ2pInonsing);\n\tand, optionally, \"verbose\" for more verbose output.\nEXITING.\n");
    exit(0); 
  }
  if(argc>=8 && !strcmp(argv[7],"verbose"))
    q=0;
  if(argc>=7)//filter
    ruleouthopf(argv[1], argv[2], argv[3], atoi(argv[4]), atoi(argv[5]), argv[6], effort, q);
  else
    ruleouthopf(argv[1], argv[2], argv[3], atoi(argv[4]), atoi(argv[5]), effort, q);
  return 0;
}

